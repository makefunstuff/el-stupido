# el-stupido project manifest
# composable primitives compiler â€” tiny LLMs emit JSON, compiler wires building blocks

[project]
name = el-stupido
desc = composable primitives compiler: LLMs pick+wire reusable blocks, compiler generates glue
bin = esc
lang = Rust
build = cd compiler && cargo build
run = ./compiler/target/debug/esc <subcommand>

[architecture]
pipeline = JSON manifest -> validate -> emit C -> cc -> native binary
thesis = programs are compositions of reusable primitives (30-80 tokens of constrained JSON)
primitives = small reusable building blocks (5-15 LOC each), LLM picks and wires them
library = grows over time; each new primitive multiplies possible programs without changing compiler

[subcommands]
compose = JSON manifest -> validate -> emit C -> compile -> binary
expand = JSON manifest -> print generated C source
grammar = print GBNF grammar for constrained LLM output
primitives = list all available primitives with params/provides/requires

[primitives]
http_listen = HTTP server with fork-per-connection (port:u16) -> provides:server
route = HTTP route handler (method:str, path:str, handler:str) -> requires:server
grug_store = persistent key-value storage (name:str, fields:str[]) -> provides:persistence
html_list = HTML table listing entries (model:str) -> requires:persistence,server
html_form = HTML form for creating entries (fields:str[]) -> requires:server
json_respond = JSON API response (model:str) -> requires:persistence,server
gpio_read = read GPIO pin (pin:u16) -> provides:sensor
gpio_write = write GPIO pin (pin:u16) -> provides:actuator
threshold = compare sensor and trigger action (source:str, above:f64, action:str) -> requires:sensor
timer_loop = periodic execution loop (interval_ms:u64) -> provides:loop

[source]
main = compiler/src/main.rs (CLI entry point, 4 subcommands)
primitive = compiler/src/primitive.rs (Primitive/ParamDef types, Registry with 10 builtins)
compose = compiler/src/compose.rs (Manifest JSON parsing, validation -> ValidComposition)
emit = compiler/src/emit.rs (C code emitter: grug impl, HTTP server, handlers, dispatch, main)
grammar = compiler/src/grammar.rs (GBNF grammar auto-generation from registry)

[examples]
guestbook = examples/compose_guestbook.json (7 primitives: http+routes+grug+html_list+html_form)

[notes]
readme = DO NOT MODIFY README.md (human-written)
old_code = all old C source/libs/tools/specs deleted, project is Rust-only now
